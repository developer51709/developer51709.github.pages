<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Discord Announcement Sender</title>

  <!-- Discord-like font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #1e1f22;
      color: #fff;
      margin: 0;
      padding: 20px;
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      box-sizing: border-box;
    }

    h2 {
      margin-top: 0;
      margin-bottom: 16px;
      font-weight: 600;
    }

    .panel {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(12px);
      padding: 20px;
      border-radius: 12px;
      flex: 1;
      min-width: 320px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
      box-sizing: border-box;
    }

    input, textarea, select, button {
      width: 100%;
      margin-bottom: 12px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      background: #2b2d31;
      color: white;
      font-size: 14px;
      box-sizing: border-box;
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    button {
      background: #5865F2;
      cursor: pointer;
      font-weight: 600;
    }

    button:hover {
      background: #4752C4;
    }

    /* Fields UI */
    h3 {
      margin-top: 12px;
      margin-bottom: 8px;
      font-size: 15px;
      font-weight: 500;
    }

    .field {
      background: #232428;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      cursor: grab;
    }

    .field.dragging {
      opacity: 0.4;
    }

    .field-row {
      display: flex;
      gap: 10px;
    }

    .field-row input[type="text"] {
      flex: 1;
    }

    .remove-btn {
      background: #ED4245;
      padding: 6px;
      border-radius: 6px;
      cursor: pointer;
      text-align: center;
      font-size: 13px;
      font-weight: 500;
      user-select: none;
    }

    .remove-btn:hover {
      background: #A12F33;
    }

    /* Discord embed preview */
    .embed {
      background: #2b2d31;
      border-left: 4px solid #5865F2;
      padding: 16px;
      border-radius: 4px;
      max-width: 100%;
      word-wrap: break-word;
      font-size: 14px;
      line-height: 1.3;
      color: #fff;
      position: relative;
      box-sizing: border-box;
    }

    .embed-title {
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 6px;
    }

    .embed-description {
      white-space: pre-line;
      margin-bottom: 10px;
      color: #dcddde;
    }

    .embed-thumbnail {
      float: right;
      width: 80px;
      height: 80px;
      border-radius: 4px;
      object-fit: cover;
      margin-left: 10px;
    }

    .embed-image {
      max-width: 100%;
      border-radius: 4px;
      margin-top: 10px;
      display: block;
    }

    .embed-footer {
      font-size: 12px;
      color: #b9bbbe;
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
      min-height: 1em;
    }

    .embed-footer img {
      width: 20px;
      height: 20px;
      border-radius: 50%;
    }

    .embed-field {
      margin-bottom: 8px;
    }

    .embed-field-name {
      font-weight: 600;
      color: #fff;
      display: block;
    }

    .embed-field-value {
      color: #dcddde;
      white-space: pre-line;
    }

    @media (max-width: 700px) {
      body {
        flex-direction: column;
      }

      .panel {
        width: 100%;
      }
    }
  </style>
</head>
<body>

<div class="panel">
  <h2>Announcement Builder</h2>

  <input id="webhook" placeholder="Webhook URL">

  <input id="title" placeholder="Embed Title" oninput="updatePreview()">
  <textarea id="description" placeholder="Embed Description" oninput="updatePreview()"></textarea>

  <select id="presetColor" onchange="applyPresetColor()">
    <option value="">Choose a preset colorâ€¦</option>
    <option value="#5865F2">Discord Blurple</option>
    <option value="#57F287">Green</option>
    <option value="#ED4245">Red</option>
    <option value="#FEE75C">Gold</option>
    <option value="#EB459E">Pink</option>
    <option value="#010101">Black</option>
  </select>

  <input id="color" placeholder="Custom Color (hex)" oninput="updatePreview()">

  <input id="thumbnail" placeholder="Thumbnail URL" oninput="updatePreview()">
  <input id="image" placeholder="Image URL" oninput="updatePreview()">
  <input id="footer" placeholder="Footer Text" oninput="updatePreview()">
  <input id="footerIcon" placeholder="Footer Icon URL" oninput="updatePreview()">

  <h3>Embed Fields</h3>
  <div id="fieldsContainer"></div>
  <button type="button" onclick="addField()">Add Field</button>

  <button style="margin-top: 16px;" onclick="sendEmbed()">Send Announcement</button>
</div>

<div class="panel">
  <h2>Live Preview</h2>

  <div class="embed" id="embedPreview">
    <img id="pThumbnail" class="embed-thumbnail" style="display:none;">
    <div class="embed-title" id="pTitle">Your title here</div>
    <div class="embed-description" id="pDescription">Your description here</div>
    <div id="pFields"></div>
    <img id="pImage" class="embed-image" style="display:none;">
    <div class="embed-footer" id="pFooter"></div>
  </div>
</div>

<script>
let fieldCount = 0;

function updatePreview() {
    const title = document.getElementById("title").value;
    const desc = document.getElementById("description").value;
    const color = document.getElementById("color").value;
    const thumbnail = document.getElementById("thumbnail").value;
    const image = document.getElementById("image").value;
    const footer = document.getElementById("footer").value;
    const footerIcon = document.getElementById("footerIcon").value;

    // Title & description
    document.getElementById("pTitle").textContent = title || "Your title here";
    document.getElementById("pDescription").textContent = desc || "Your description here";

    // Color strip
    if (color) {
        document.querySelector(".embed").style.borderColor = color;
    } else {
        document.querySelector(".embed").style.borderColor = "#5865F2";
    }

    // Thumbnail
    const thumbEl = document.getElementById("pThumbnail");
    if (thumbnail) {
        thumbEl.src = thumbnail;
        thumbEl.style.display = "block";
    } else {
        thumbEl.style.display = "none";
    }

    // Main image
    const imgEl = document.getElementById("pImage");
    if (image) {
        imgEl.src = image;
        imgEl.style.display = "block";
    } else {
        imgEl.style.display = "none";
    }

    // Footer
    const footerEl = document.getElementById("pFooter");
    footerEl.innerHTML = "";

    if (footerIcon) {
        const icon = document.createElement("img");
        icon.src = footerIcon;
        footerEl.appendChild(icon);
    }

    if (footer) {
        const text = document.createElement("span");
        text.textContent = footer;
        footerEl.appendChild(text);
    }

    // Fields preview
    const pFields = document.getElementById("pFields");
    pFields.innerHTML = "";

    const fields = [...document.querySelectorAll(".field")];

    fields.forEach(f => {
        const name = f.querySelector(".field-name").value;
        const value = f.querySelector(".field-value").value;

        if (!name && !value) return;

        const div = document.createElement("div");
        div.className = "embed-field";

        const nameEl = document.createElement("div");
        nameEl.className = "embed-field-name";
        nameEl.textContent = name || "\u200b";

        const valueEl = document.createElement("div");
        valueEl.className = "embed-field-value";
        valueEl.textContent = value || "\u200b";

        div.appendChild(nameEl);
        div.appendChild(valueEl);
        pFields.appendChild(div);
    });
}

function applyPresetColor() {
    const preset = document.getElementById("presetColor").value;
    if (preset) {
        document.getElementById("color").value = preset;
        updatePreview();
    }
}

function addField() {
    const container = document.getElementById("fieldsContainer");

    const field = document.createElement("div");
    field.className = "field";
    field.draggable = true;
    field.dataset.index = fieldCount++;

    field.innerHTML = `
        <div class="field-row">
            <input type="text" placeholder="Field Name" class="field-name" oninput="updatePreview()">
            <input type="text" placeholder="Field Value" class="field-value" oninput="updatePreview()">
        </div>
        <label style="font-size: 13px;">
            <input type="checkbox" class="field-inline" onchange="updatePreview()" style="width:auto; margin-right:6px;">
            Inline
        </label>
        <div class="remove-btn" onclick="this.parentElement.remove(); updatePreview()">Remove Field</div>
    `;

    enableDrag(field);
    container.appendChild(field);
    updatePreview();
}

function enableDrag(field) {
    field.addEventListener("dragstart", () => {
        field.classList.add("dragging");
    });

    field.addEventListener("dragend", () => {
        field.classList.remove("dragging");
        updatePreview();
    });

    const container = document.getElementById("fieldsContainer");
    if (!container.dataset.dragBound) {
        container.addEventListener("dragover", e => {
            e.preventDefault();
            const dragging = document.querySelector(".field.dragging");
            if (!dragging) return;
            const after = getDragAfterElement(container, e.clientY);
            if (after == null) {
                container.appendChild(dragging);
            } else {
                container.insertBefore(dragging, after);
            }
        });
        container.dataset.dragBound = "true";
    }
}

function getDragAfterElement(container, y) {
    const elements = [...container.querySelectorAll(".field:not(.dragging)")];

    return elements.reduce((closest, child) => {
        const box = child.getBoundingClientRect();
        const offset = y - box.top - box.height / 2;
        if (offset < 0 && offset > closest.offset) {
            return { offset, element: child };
        } else {
            return closest;
        }
    }, { offset: Number.NEGATIVE_INFINITY, element: null }).element;
}

function collectFieldsForWebhook() {
    const fields = [...document.querySelectorAll(".field")].map(f => ({
        name: f.querySelector(".field-name").value,
        value: f.querySelector(".field-value").value,
        inline: f.querySelector(".field-inline").checked
    }));

    return fields.filter(f => f.name || f.value);
}

function sendEmbed() {
    const webhook = document.getElementById("webhook").value.trim();
    if (!webhook) {
        alert("Please enter a webhook URL.");
        return;
    }

    const colorHex = document.getElementById("color").value.trim() || "#5865F2";
    let colorInt = parseInt(colorHex.replace("#", ""), 16);
    if (isNaN(colorInt)) {
        colorInt = parseInt("5865F2", 16);
    }

    const embed = {
        title: document.getElementById("title").value || null,
        description: document.getElementById("description").value || null,
        color: colorInt,
        thumbnail: { url: document.getElementById("thumbnail").value || null },
        image: { url: document.getElementById("image").value || null },
        footer: {
            text: document.getElementById("footer").value || null,
            icon_url: document.getElementById("footerIcon").value || null
        },
        fields: collectFieldsForWebhook()
    };

    // Clean up null-ish objects
    if (!embed.thumbnail.url) delete embed.thumbnail;
    if (!embed.image.url) delete embed.image;
    if (!embed.footer.text && !embed.footer.icon_url) delete embed.footer;
    if (!embed.fields.length) delete embed.fields;

    fetch(webhook, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ embeds: [embed] })
    })
    .then(res => {
        if (!res.ok) throw new Error("HTTP " + res.status);
        alert("Announcement sent!");
    })
    .catch(err => alert("Error sending announcement: " + err.message));
}

// Initialize with one empty field
addField();
</script>

</body>
</html>
